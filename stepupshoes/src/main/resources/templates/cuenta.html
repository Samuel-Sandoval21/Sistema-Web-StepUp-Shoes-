<!DOCTYPE html>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/Other/html.html to edit this template
-->
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: head">
    <title>Mi Cuenta - StepUp Shoes</title>
</head>
<body>
    <div th:replace="fragments/header :: header"></div>
    <div th:replace="fragments/nav :: nav"></div>

    <div class="cuenta-container">
        <div class="cuenta-sidebar">
            <div class="user-profile">
                <div class="user-avatar">
                    <img th:src="${usuario.avatarUrl}" th:alt="${usuario.nombre}" th:if="${usuario.avatarUrl}">
                    <div class="avatar-placeholder" th:unless="${usuario.avatarUrl}">
                        [[${#strings.substring(usuario.nombre, 0, 1)}]]
                    </div>
                </div>
                <div class="user-info">
                    <h3 th:text="${usuario.nombre}"></h3>
                    <p th:text="${usuario.email}"></p>
                    <span class="member-since" th:text="'Miembro desde ' + ${#temporals.format(usuario.fechaRegistro, 'MMMM yyyy')}"></span>
                </div>
            </div>

            <nav class="cuenta-menu">
                <a href="#perfil" class="menu-item active" onclick="mostrarSeccion('perfil')">
                    <span class="menu-icon">üë§</span>
                    Mi Perfil
                </a>
                <a href="#pedidos" class="menu-item" onclick="mostrarSeccion('pedidos')">
                    <span class="menu-icon">üì¶</span>
                    Mis Pedidos
                </a>
                <a href="#direcciones" class="menu-item" onclick="mostrarSeccion('direcciones')">
                    <span class="menu-icon">üè†</span>
                    Direcciones
                </a>
                <a href="#favoritos" class="menu-item" onclick="mostrarSeccion('favoritos')">
                    <span class="menu-icon">‚ù§Ô∏è</span>
                    Favoritos
                </a>
                <a href="#seguridad" class="menu-item" onclick="mostrarSeccion('seguridad')">
                    <span class="menu-icon">üîí</span>
                    Seguridad
                </a>
                <a th:href="@{/logout}" class="menu-item logout">
                    <span class="menu-icon">üö™</span>
                    Cerrar Sesi√≥n
                </a>
            </nav>
        </div>

        <div class="cuenta-content">
            <!-- Secci√≥n Perfil -->
            <div id="perfil" class="cuenta-seccion active">
                <div class="seccion-header">
                    <h2>Mi Perfil</h2>
                    <p>Gestiona tu informaci√≥n personal</p>
                </div>

                <form class="profile-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="profileNombre">Nombre Completo</label>
                            <input type="text" id="profileNombre" th:value="${usuario.nombre}">
                        </div>
                        <div class="form-group">
                            <label for="profileEmail">Email</label>
                            <input type="email" id="profileEmail" th:value="${usuario.email}" readonly>
                        </div>
                        <div class="form-group">
                            <label for="profileTelefono">Tel√©fono</label>
                            <input type="tel" id="profileTelefono" placeholder="+506 1234 5678">
                        </div>
                        <div class="form-group">
                            <label for="profileFechaNacimiento">Fecha de Nacimiento</label>
                            <input type="date" id="profileFechaNacimiento">
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn btn-outline">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                    </div>
                </form>

                <div class="account-stats">
                    <h3>Tu actividad en StepUp</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" th:text="${totalPedidos} ?: '0'">0</div>
                            <div class="stat-label">Pedidos Realizados</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" th:text="${totalFavoritos} ?: '0'">0</div>
                            <div class="stat-label">Productos Favoritos</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" th:text="'$' + (${totalGastado} ?: '0')">$0</div>
                            <div class="stat-label">Total Gastado</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" th:text="${puntos} ?: '0'">0</div>
                            <div class="stat-label">Puntos Acumulados</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Secci√≥n Pedidos -->
            <div id="pedidos" class="cuenta-seccion">
                <div class="seccion-header">
                    <h2>Mis Pedidos</h2>
                    <p>Revisa el estado de tus compras</p>
                </div>

                <div class="pedidos-list">
                    <div th:each="pedido : ${pedidos}" class="pedido-card">
                        <div class="pedido-header">
                            <div class="pedido-info">
                                <h4 th:text="'Pedido #' + ${pedido.numero}">Pedido #042AB643</h4>
                                <span class="pedido-fecha" th:text="${#temporals.format(pedido.fechaCreacion, 'dd MMMM yyyy, HH:mm')}"></span>
                            </div>
                            <div class="pedido-estado" th:classappend="${pedido.estado}">
                                <span th:text="${pedido.estado}">PENDIENTE</span>
                            </div>
                        </div>

                        <div class="pedido-items">
                            <div th:each="item : ${pedido.detalles}" class="pedido-item">
                                <img th:src="${item.producto.imagenUrl}" th:alt="${item.producto.nombre}" class="item-image">
                                <div class="item-info">
                                    <h5 th:text="${item.producto.nombre}"></h5>
                                    <span class="item-details" th:text="'Talla: ' + ${item.talla} + ' | Cantidad: ' + ${item.cantidad}"></span>
                                </div>
                                <div class="item-price" th:text="'$' + ${#numbers.formatDecimal(item.precio * item.cantidad, 1, 2)}"></div>
                            </div>
                        </div>

                        <div class="pedido-footer">
                            <div class="pedido-total" th:text="'Total: $' + ${#numbers.formatDecimal(pedido.total, 1, 2)}"></div>
                            <div class="pedido-actions">
                                <button class="btn btn-outline btn-sm">Ver Detalles</button>
                                <button class="btn btn-outline btn-sm" th:if="${pedido.estado == 'ENTREGADO'}">Devolver</button>
                                <button class="btn btn-outline btn-sm" th:if="${pedido.estado == 'PENDIENTE'}">Cancelar</button>
                            </div>
                        </div>
                    </div>

                    <div th:if="${#lists.isEmpty(pedidos)}" class="no-pedidos">
                        <div class="empty-state">
                            <div class="empty-icon">üì¶</div>
                            <h3>No tienes pedidos a√∫n</h3>
                            <p>Explora nuestro cat√°logo y realiza tu primera compra</p>
                            <a th:href="@{/catalogo}" class="btn btn-primary">Explorar Productos</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Secci√≥n Direcciones -->
            <div id="direcciones" class="cuenta-seccion">
                <div class="seccion-header">
                    <h2>Mis Direcciones</h2>
                    <p>Gestiona tus direcciones de env√≠o</p>
                </div>

                <div class="direcciones-grid">
                    <div class="direccion-card">
                        <div class="direccion-header">
                            <h4>Direcci√≥n Principal</h4>
                            <span class="direccion-default">Predeterminada</span>
                        </div>
                        <div class="direccion-info">
                            <p><strong>Juan P√©rez</strong></p>
                            <p>Calle 123, #45-67</p>
                            <p>San Jos√©, San Jos√©</p>
                            <p>10101, Costa Rica</p>
                            <p>üìû +506 1234 5678</p>
                        </div>
                        <div class="direccion-actions">
                            <button class="btn-link">Editar</button>
                            <button class="btn-link text-danger">Eliminar</button>
                        </div>
                    </div>

                    <div class="direccion-card add-direccion">
                        <div class="add-direccion-content">
                            <span class="add-icon">+</span>
                            <h4>Agregar Nueva Direcci√≥n</h4>
                            <p>Agrega una nueva direcci√≥n de env√≠o</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Secci√≥n Favoritos -->
            <div id="favoritos" class="cuenta-seccion">
                <div class="seccion-header">
                    <h2>Mis Favoritos</h2>
                    <p>Productos que te han gustado</p>
                </div>

                <div class="favoritos-grid">
                    <div th:each="producto : ${favoritos}" class="favorito-card">
                        <img th:src="${producto.imagenUrl}" th:alt="${producto.nombre}" class="favorito-image">
                        <div class="favorito-info">
                            <h5 th:text="${producto.nombre}"></h5>
                            <p class="favorito-precio" th:text="'$' + ${#numbers.formatDecimal(producto.precio, 1, 2)}"></p>
                        </div>
                        <div class="favorito-actions">
                            <button class="btn btn-primary btn-sm">Agregar al Carrito</button>
                            <button class="btn-remove-favorito" onclick="removerFavorito([[${producto.id}]])">üóëÔ∏è</button>
                        </div>
                    </div>

                    <div th:if="${#lists.isEmpty(favoritos)}" class="no-favoritos">
                        <div class="empty-state">
                            <div class="empty-icon">‚ù§Ô∏è</div>
                            <h3>No tienes productos favoritos</h3>
                            <p>Agrega productos a tus favoritos para verlos aqu√≠</p>
                            <a th:href="@{/catalogo}" class="btn btn-primary">Explorar Cat√°logo</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Secci√≥n Seguridad -->
            <div id="seguridad" class="cuenta-seccion">
                <div class="seccion-header">
                    <h2>Seguridad</h2>
                    <p>Gestiona la seguridad de tu cuenta</p>
                </div>

                <div class="security-options">
                    <div class="security-card">
                        <h4>Cambiar Contrase√±a</h4>
                        <p>Actualiza tu contrase√±a regularmente para mantener tu cuenta segura</p>
                        <button class="btn btn-outline" onclick="mostrarCambioContrasena()">Cambiar Contrase√±a</button>
                    </div>

                    <div class="security-card">
                        <h4>Verificaci√≥n en Dos Pasos</h4>
                        <p>Agrega una capa extra de seguridad a tu cuenta</p>
                        <button class="btn btn-outline">Activar 2FA</button>
                    </div>

                    <div class="security-card">
                        <h4>Sesiones Activas</h4>
                        <p>Gestiona los dispositivos donde has iniciado sesi√≥n</p>
                        <button class="btn btn-outline">Ver Sesiones</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div th:replace="fragments/footer :: footer"></div>

    <script>
    function mostrarSeccion(seccionId) {
        // Ocultar todas las secciones
        document.querySelectorAll('.cuenta-seccion').forEach(seccion => {
            seccion.classList.remove('active');
        });
        
        // Remover activo de todos los items del men√∫
        document.querySelectorAll('.menu-item').forEach(item => {
            item.classList.remove('active');
        });
        
        // Mostrar secci√≥n seleccionada
        document.getElementById(seccionId).classList.add('active');
        
        // Activar item del men√∫
        event.target.classList.add('active');
    }

    function removerFavorito(productoId) {
        if (confirm('¬øEst√°s seguro de que quieres eliminar este producto de tus favoritos?')) {
            // L√≥gica para eliminar de favoritos
            console.log('Eliminando favorito:', productoId);
            event.target.closest('.favorito-card').remove();
        }
    }

    function mostrarCambioContrasena() {
        // L√≥gica para mostrar modal de cambio de contrase√±a
        alert('Funcionalidad de cambio de contrase√±a');
    }
    </script>

    <style>
    .cuenta-container {
        display: grid;
        grid-template-columns: 300px 1fr;
        min-height: 80vh;
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
        gap: 2rem;
    }

    .cuenta-sidebar {
        background: var(--white);
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        padding: 2rem;
        height: fit-content;
        position: sticky;
        top: 2rem;
    }

    .user-profile {
        text-align: center;
        margin-bottom: 2rem;
        padding-bottom: 2rem;
        border-bottom: 1px solid var(--light-gray);
    }

    .user-avatar {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        margin: 0 auto 1rem;
        overflow: hidden;
        background: var(--primary-color);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        font-weight: bold;
    }

    .user-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .user-info h3 {
        margin: 0 0 0.25rem;
        color: var(--secondary-color);
    }

    .user-info p {
        margin: 0 0 0.5rem;
        color: #666;
        font-size: 0.9rem;
    }

    .member-since {
        font-size: 0.8rem;
        color: #999;
    }

    .cuenta-menu {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .menu-item {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem;
        text-decoration: none;
        color: var(--dark-gray);
        border-radius: var(--border-radius);
        transition: all 0.3s ease;
    }

    .menu-item:hover,
    .menu-item.active {
        background: var(--primary-color);
        color: white;
    }

    .menu-item.logout {
        color: #e74c3c;
        margin-top: 1rem;
        border-top: 1px solid var(--light-gray);
        padding-top: 1.5rem;
    }

    .menu-item.logout:hover {
        background: #fdf2f2;
        color: #e74c3c;
    }

    .menu-icon {
        font-size: 1.2rem;
        width: 20px;
        text-align: center;
    }

    .cuenta-content {
        background: var(--white);
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        padding: 2rem;
    }

    .cuenta-seccion {
        display: none;
    }

    .cuenta-seccion.active {
        display: block;
        animation: fadeIn 0.3s ease;
    }

    .seccion-header {
        margin-bottom: 2rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--light-gray);
    }

    .seccion-header h2 {
        color: var(--secondary-color);
        margin: 0 0 0.5rem;
    }

    .seccion-header p {
        color: #666;
        margin: 0;
    }

    .profile-form {
        margin-bottom: 3rem;
    }

    .form-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    .form-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .form-group label {
        font-weight: 500;
        color: var(--secondary-color);
    }

    .form-group input {
        padding: 0.75rem;
        border: 1px solid #ddd;
        border-radius: var(--border-radius);
        font-size: 1rem;
    }

    .form-actions {
        display: flex;
        gap: 1rem;
        justify-content: flex-end;
    }

    .account-stats {
        background: var(--light-gray);
        padding: 2rem;
        border-radius: var(--border-radius);
    }

    .account-stats h3 {
        margin: 0 0 1.5rem;
        color: var(--secondary-color);
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 1rem;
    }

    .stat-card {
        background: var(--white);
        padding: 1.5rem;
        border-radius: var(--border-radius);
        text-align: center;
        box-shadow: var(--shadow);
    }

    .stat-number {
        font-size: 2rem;
        font-weight: bold;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
    }

    .stat-label {
        color: #666;
        font-size: 0.9rem;
    }

    .pedidos-list {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
    }

    .pedido-card {
        border: 1px solid var(--light-gray);
        border-radius: var(--border-radius);
        overflow: hidden;
    }

    .pedido-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.5rem;
        background: var(--light-gray);
    }

    .pedido-info h4 {
        margin: 0 0 0.25rem;
        color: var(--secondary-color);
    }

    .pedido-fecha {
        color: #666;
        font-size: 0.9rem;
    }

    .pedido-estado {
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
        text-transform: uppercase;
    }

    .pedido-estado.PENDIENTE {
        background: #fff3cd;
        color: #856404;
    }

    .pedido-estado.ENVIADO {
        background: #d1ecf1;
        color: #0c5460;
    }

    .pedido-estado.ENTREGADO {
        background: #d4edda;
        color: #155724;
    }

    .pedido-items {
        padding: 1.5rem;
    }

    .pedido-item {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem 0;
        border-bottom: 1px solid var(--light-gray);
    }

    .pedido-item:last-child {
        border-bottom: none;
    }

    .item-image {
        width: 60px;
        height: 60px;
        object-fit: cover;
        border-radius: var(--border-radius);
    }

    .item-info {
        flex: 1;
    }

    .item-info h5 {
        margin: 0 0 0.25rem;
        color: var(--secondary-color);
    }

    .item-details {
        color: #666;
        font-size: 0.9rem;
    }

    .item-price {
        font-weight: 600;
        color: var(--primary-color);
    }

    .pedido-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.5rem;
        background: var(--light-gray);
    }

    .pedido-total {
        font-weight: 600;
        color: var(--secondary-color);
        font-size: 1.1rem;
    }

    .pedido-actions {
        display: flex;
        gap: 0.5rem;
    }

    .btn-sm {
        padding: 0.5rem 1rem;
        font-size: 0.8rem;
    }

    .direcciones-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
    }

    .direccion-card {
        border: 1px solid var(--light-gray);
        border-radius: var(--border-radius);
        padding: 1.5rem;
        position: relative;
    }

    .direccion-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--light-gray);
    }

    .direccion-header h4 {
        margin: 0;
        color: var(--secondary-color);
    }

    .direccion-default {
        background: var(--primary-color);
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.7rem;
        font-weight: 500;
    }

    .direccion-info p {
        margin: 0.5rem 0;
        color: #666;
    }

    .direccion-actions {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
    }

    .btn-link {
        background: none;
        border: none;
        color: var(--accent-color);
        cursor: pointer;
        text-decoration: underline;
    }

    .text-danger {
        color: #e74c3c;
    }

    .add-direccion {
        border: 2px dashed #ddd;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .add-direccion:hover {
        border-color: var(--primary-color);
        background: #fff9f8;
    }

    .add-direccion-content {
        text-align: center;
    }

    .add-icon {
        font-size: 3rem;
        color: var(--primary-color);
        display: block;
        margin-bottom: 1rem;
    }

    .add-direccion h4 {
        margin: 0 0 0.5rem;
        color: var(--secondary-color);
    }

    .add-direccion p {
        margin: 0;
        color: #666;
        font-size: 0.9rem;
    }

    .favoritos-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 1.5rem;
    }

    .favorito-card {
        border: 1px solid var(--light-gray);
        border-radius: var(--border-radius);
        overflow: hidden;
        transition: transform 0.3s ease;
    }

    .favorito-card:hover {
        transform: translateY(-5px);
    }

    .favorito-image {
        width: 100%;
        height: 150px;
        object-fit: cover;
    }

    .favorito-info {
        padding: 1rem;
    }

    .favorito-info h5 {
        margin: 0 0 0.5rem;
        color: var(--secondary-color);
    }

    .favorito-precio {
        font-weight: 600;
        color: var(--primary-color);
        margin: 0;
    }

    .favorito-actions {
        padding: 1rem;
        display: flex;
        gap: 0.5rem;
        border-top: 1px solid var(--light-gray);
    }

    .btn-remove-favorito {
        background: none;
        border: none;
        cursor: pointer;
        padding: 0.5rem;
        border-radius: var(--border-radius);
        transition: background-color 0.3s ease;
    }

    .btn-remove-favorito:hover {
        background: #fdf2f2;
    }

    .security-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
    }

    .security-card {
        border: 1px solid var(--light-gray);
        border-radius: var(--border-radius);
        padding: 1.5rem;
    }

    .security-card h4 {
        margin: 0 0 0.5rem;
        color: var(--secondary-color);
    }

    .security-card p {
        margin: 0 0 1rem;
        color: #666;
        font-size: 0.9rem;
    }

    .empty-state {
        text-align: center;
        padding: 3rem 2rem;
        color: #666;
    }

    .empty-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
        opacity: 0.5;
    }

    .empty-state h3 {
        color: var(--secondary-color);
        margin-bottom: 1rem;
    }

    .empty-state p {
        margin-bottom: 2rem;
    }

    @media (max-width: 968px) {
        .cuenta-container {
            grid-template-columns: 1fr;
        }
        
        .cuenta-sidebar {
            position: static;
        }
        
        .form-grid {
            grid-template-columns: 1fr;
        }
    }

    @media (max-width: 768px) {
        .cuenta-container {
            padding: 1rem;
        }
        
        .pedido-header,
        .pedido-footer {
            flex-direction: column;
            gap: 1rem;
            align-items: flex-start;
        }
        
        .direcciones-grid,
        .favoritos-grid,
        .security-options {
            grid-template-columns: 1fr;
        }
    }
    </style>
</body>
</html>